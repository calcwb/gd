<html>
  <head>
    <title>Governador Ao Vivo</title>
    <link
       rel="stylesheet" type="text/css"
       href="{{ url_for('static', filename='css/978.css') }}">
    <link
       rel="stylesheet" type="text/css"
       href="{{ url_for('.static', filename='css/tv.css') }}">
  </head>
  <body class="buzz">
    <h1>Governador Pergunta</h1>

    <ul id="notices">
      {% for notice in buzz %}
      <li>
        <img src="{{ notice.avatar }}">
        <div class="author">
          {% if notice.user %}
            {{ notice.user.display_name }}
          {% else %}
            @{{ notice.owner_nick }}
          {% endif %}
          <em>| {{ notice.type_.name }}</em>
        </div>
        <div class="content">{{ notice.content }}</div>
        <div class="row-end"></div>
      </li>
      {% endfor %}
    </ul>

    <script type="text/html" id="noticeTemplate">
      <li>
        <img src="<%= obj.avatar %>">
        <div class="author">
          <% if (obj.user) { %>
            <%= obj.user.display_name %>
          <% } else { %>
            @<%= obj.owner_nick %>
          <% } %>
          <em>| <%= obj.type_.name %></em>
        </div>
        <div class="content"><%= obj.content %></div>
      </li>
    </script>

    <script type="text/javascript">var SIO_BASE = "{{ host }}";</script>
    <script src="{{ url_for('static', filename='js/jquery-1.5.1.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/template.js') }}"></script>
    <script src="{{ url_for('buzz.static', filename='js/socket.io.js') }}"></script>
    <script src="{{ url_for('buzz.static', filename='js/buzz.js') }}"></script>
    <script>
      $(function () {
          new Buzz(SIO_BASE, {
              buzz_accepted: function (msg) {
                  $('#notices').prepend($(tmpl("noticeTemplate", msg)));
              }
          });
      });
    </script>
  </body>
</html>
